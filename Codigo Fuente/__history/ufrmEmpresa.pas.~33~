unit ufrmEmpresa;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ufrmCatalogo, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, dxSkinsCore, dxSkinBlack, dxSkinBlue, dxSkinCaramel,
  dxSkinCoffee, dxSkinDarkRoom, dxSkinDarkSide, dxSkinFoggy, dxSkinGlassOceans,
  dxSkiniMaginary, dxSkinLilian, dxSkinLiquidSky, dxSkinLondonLiquidSky,
  dxSkinMcSkin, dxSkinMoneyTwins, dxSkinOffice2007Black, dxSkinOffice2007Blue,
  dxSkinOffice2007Green, dxSkinOffice2007Pink, dxSkinOffice2007Silver,
  dxSkinPumpkin, dxSkinSeven, dxSkinSharp, dxSkinSilver, dxSkinSpringTime,
  dxSkinStardust, dxSkinSummer2008, dxSkinsDefaultPainters, dxSkinValentine,
  dxSkinXmas2008Blue, dxSkinscxPCPainter, cxStyles, cxCustomData, cxFilter,
  cxData, cxDataStorage, cxEdit, DB, cxDBData, dxmdaset, uDAInterfaces,
  uDADataTable, uDAScriptingProvider, uDAMemDataTable, cxGridLevel, cxClasses,
  cxGridCustomView, cxGridCustomTableView, cxGridTableView, cxGridDBTableView,
  cxGrid, cxPC, cxContainer, cxTextEdit, cxDBEdit, cxLabel, ExtCtrls, Menus,
  StdCtrls, cxButtons;

type
  TfrmEmpresa = class(TfrmCatalogo)
    dbgCatalogoDBTableView1RecID: TcxGridDBColumn;
    dbgCatalogoDBTableView1IDEMPRESA: TcxGridDBColumn;
    dbgCatalogoDBTableView1NOMBRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1RAZONSOCIAL: TcxGridDBColumn;
    dbgCatalogoDBTableView1RFC: TcxGridDBColumn;
    dbgCatalogoDBTableView1CLAVEPEMEX: TcxGridDBColumn;
    dbgCatalogoDBTableView1BOMBAS: TcxGridDBColumn;
    dbgCatalogoDBTableView1COLONIA: TcxGridDBColumn;
    dbgCatalogoDBTableView1CIUDAD: TcxGridDBColumn;
    dbgCatalogoDBTableView1CODIGOPOSTAL: TcxGridDBColumn;
    dbgCatalogoDBTableView1HOST: TcxGridDBColumn;
    dbgCatalogoDBTableView1CC: TcxGridDBColumn;
    dbgCatalogoDBTableView1IMPUESTO: TcxGridDBColumn;
    Panel1: TPanel;
    Panel2: TPanel;
    TxtNoProducto: TcxDBTextEdit;
    TxtNombre: TcxDBTextEdit;
    LblNombre: TcxLabel;
    LblNoProducto: TcxLabel;
    cxLabel1: TcxLabel;
    cxDBTextEdit1: TcxDBTextEdit;
    cxLabel2: TcxLabel;
    cxDBTextEdit2: TcxDBTextEdit;
    cxDBTextEdit3: TcxDBTextEdit;
    cxLabel3: TcxLabel;
    cxLabel4: TcxLabel;
    cxDBTextEdit4: TcxDBTextEdit;
    cxDBTextEdit8: TcxDBTextEdit;
    cxLabel8: TcxLabel;
    cxDBTextEdit9: TcxDBTextEdit;
    cxLabel9: TcxLabel;
    cxLabel10: TcxLabel;
    cxDBTextEdit10: TcxDBTextEdit;
    cxDBTextEdit5: TcxDBTextEdit;
    cxLabel5: TcxLabel;
    cxDBTextEdit6: TcxDBTextEdit;
    cxLabel6: TcxLabel;
    cxLabel7: TcxLabel;
    cxDBTextEdit7: TcxDBTextEdit;
    cxLabel11: TcxLabel;
    cxDBTextEdit11: TcxDBTextEdit;
    cxDBTextEdit12: TcxDBTextEdit;
    cxLabel12: TcxLabel;
    cxButton2: TcxButton;
    cxDBTextEdit13: TcxDBTextEdit;
    cxLabel13: TcxLabel;
    procedure cdsCatalogoNewRecord(DataTable: TDADataTable);
    procedure cdsCatalogoBeforePost(DataTable: TDADataTable);
    procedure cxButton2Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmEmpresa: TfrmEmpresa;

implementation
uses uDM, Modules, uRFC;

{$R *.dfm}

procedure TfrmEmpresa.cdsCatalogoBeforePost(DataTable: TDADataTable);
var
  S:String;
begin
  inherited;
  S:= cdsCatalogo.FieldByName('RFC').AsString;
  while (AnsiPos('-',S)>0) do Delete(S,AnsiPos('-',S),1);
  while (AnsiPos(' ',S)>0) do Delete(S,AnsiPos(' ',S),1);

  cdsCatalogo.FieldByName('RFC').AsString:= S;
end;

procedure TfrmEmpresa.cdsCatalogoNewRecord(DataTable: TDADataTable);
begin
  inherited;
  cdsCatalogo.FieldByName('IDEMPRESA').AsInteger:= DM.Servidor.Folio('IDEMPRESA','');

end;

procedure TfrmEmpresa.cxButton2Click(Sender: TObject);
begin
  inherited;
  cdsCatalogo.Edit;
  cdsCatalogo.FieldByName('RFC').AsString:=  Abrir_ModuloAyudaRFC('','','','M',Now());
end;

initialization
  ModuleInfoManager.RegisterModule('Empresa', TfrmEmpresa);

end.
