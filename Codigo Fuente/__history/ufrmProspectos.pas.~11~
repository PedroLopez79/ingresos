unit ufrmProspectos;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ufrmCatalogo, cxGraphics, cxControls, cxLookAndFeels,
  cxLookAndFeelPainters, dxSkinsCore, dxSkinBlack, dxSkinBlue, dxSkinCaramel,
  dxSkinCoffee, dxSkinDarkRoom, dxSkinDarkSide, dxSkinFoggy, dxSkinGlassOceans,
  dxSkiniMaginary, dxSkinLilian, dxSkinLiquidSky, dxSkinLondonLiquidSky,
  dxSkinMcSkin, dxSkinMoneyTwins, dxSkinOffice2007Black, dxSkinOffice2007Blue,
  dxSkinOffice2007Green, dxSkinOffice2007Pink, dxSkinOffice2007Silver,
  dxSkinPumpkin, dxSkinSeven, dxSkinSharp, dxSkinSilver, dxSkinSpringTime,
  dxSkinStardust, dxSkinSummer2008, dxSkinsDefaultPainters, dxSkinValentine,
  dxSkinXmas2008Blue, dxSkinscxPCPainter, cxStyles, cxCustomData, cxFilter,
  cxData, cxDataStorage, cxEdit, DB, cxDBData, cxContainer, cxDropDownEdit,
  cxCalendar, cxDBEdit, cxCheckBox, cxImageComboBox, cxMaskEdit, cxLookupEdit,
  cxDBLookupEdit, cxDBLookupComboBox, cxTextEdit, cxGroupBox, cxGridLevel,
  cxGridCustomTableView, cxGridTableView, cxGridDBTableView, cxClasses,
  cxGridCustomView, cxGrid, StdCtrls, cxPC, CustomModule, dxmdaset,
  uDAInterfaces, uDADataTable, uDAScriptingProvider, uDAMemDataTable,
  cxRadioGroup, cxLabel, DBCtrls, Menus, cxButtons, ExtCtrls, WPCTRRich, WPTbar,
  WPRuler, WPRTEDefs, WPCTRMemo, JPeg, ExtDlgs, Modules, cxImage, dmActions, LibraryGauss_Intf;

type
  TfrmProspectos = class(TfrmCatalogo)
    cxPageControl1: TcxPageControl;
    cxTabSheet3: TcxTabSheet;
    cxDBTextEdit2: TcxDBTextEdit;
    cxDBTextEdit3: TcxDBTextEdit;
    cxDBTextEdit4: TcxDBTextEdit;
    cxDBTextEdit6: TcxDBTextEdit;
    cxDBTextEdit7: TcxDBTextEdit;
    cxDBTextEdit8: TcxDBTextEdit;
    cxDBTextEdit9: TcxDBTextEdit;
    cxDBDateEdit1: TcxDBDateEdit;
    cxDBDateEdit2: TcxDBDateEdit;
    cxTabSheet4: TcxTabSheet;
    cxLabel2: TcxLabel;
    cxDBRadioGroup1: TcxDBRadioGroup;
    cxLabel3: TcxLabel;
    cxLabel4: TcxLabel;
    cxLabel5: TcxLabel;
    cxLabel8: TcxLabel;
    cxLabel9: TcxLabel;
    cxLabel10: TcxLabel;
    cxLabel11: TcxLabel;
    cxLabel12: TcxLabel;
    Panel1: TPanel;
    cxDBTextEdit10: TcxDBTextEdit;
    cxLabel13: TcxLabel;
    cxLabel14: TcxLabel;
    cxDBTextEdit11: TcxDBTextEdit;
    cxDBTextEdit12: TcxDBTextEdit;
    cxLabel15: TcxLabel;
    cxDBTextEdit13: TcxDBTextEdit;
    cxLabel16: TcxLabel;
    cxDBTextEdit14: TcxDBTextEdit;
    cxLabel17: TcxLabel;
    cxDBTextEdit15: TcxDBTextEdit;
    cxLabel18: TcxLabel;
    cxDBTextEdit16: TcxDBTextEdit;
    cxLabel19: TcxLabel;
    cxDBTextEdit17: TcxDBTextEdit;
    cxLabel20: TcxLabel;
    cxDBTextEdit18: TcxDBTextEdit;
    cxLabel21: TcxLabel;
    cxDBTextEdit19: TcxDBTextEdit;
    cxLabel22: TcxLabel;
    dbgCatalogoDBTableView1RecID: TcxGridDBColumn;
    dbgCatalogoDBTableView1IDALUMNO: TcxGridDBColumn;
    dbgCatalogoDBTableView1NUMCONTROL: TcxGridDBColumn;
    dbgCatalogoDBTableView1NOMBRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1FECHANACIMIENTO: TcxGridDBColumn;
    dbgCatalogoDBTableView1CURP: TcxGridDBColumn;
    dbgCatalogoDBTableView1SEXO: TcxGridDBColumn;
    dbgCatalogoDBTableView1CIUDADNACIMIENTO: TcxGridDBColumn;
    dbgCatalogoDBTableView1DIRECCION: TcxGridDBColumn;
    dbgCatalogoDBTableView1PADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1MADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1TELEFONOCASA: TcxGridDBColumn;
    dbgCatalogoDBTableView1TELEFONOPADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1TELEFONOMADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1FECHAINICIO: TcxGridDBColumn;
    dbgCatalogoDBTableView1EMAIL: TcxGridDBColumn;
    dbgCatalogoDBTableView1EMAILPADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1EMAILMADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1OBSERVACIONES: TcxGridDBColumn;
    dbgCatalogoDBTableView1IDSTATUS: TcxGridDBColumn;
    dbgCatalogoDBTableView1FOTO: TcxGridDBColumn;
    dbgCatalogoDBTableView1FACTURADOMICILIO: TcxGridDBColumn;
    dbgCatalogoDBTableView1FACTURANOMBRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1FACTURATELEFONO: TcxGridDBColumn;
    dbgCatalogoDBTableView1RFC: TcxGridDBColumn;
    dbgCatalogoDBTableView1EMPRESAPADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1EMPRESAMADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1PUESTOMADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1PUESTOPADRE: TcxGridDBColumn;
    dbgCatalogoDBTableView1APATERNO: TcxGridDBColumn;
    dbgCatalogoDBTableView1AMATERNO: TcxGridDBColumn;
    dbgCatalogoDBTableView1NOMBRES: TcxGridDBColumn;
    Panel2: TPanel;
    procedure cdsCatalogoNewRecord(DataTable: TDADataTable);
    procedure FormCreate(Sender: TObject);
    procedure memObservacionesKeyPress(Sender: TObject; var Key: Char);
  protected
    procedure RegisterActions; override;
  private
    { Private declarations }
    procedure ActionImprimir(Action: TBasicAction); override;
  public
    { Public declarations }
    procedure UpdateActionsState; override;
  end;

var
  frmProspectos: TfrmProspectos;

implementation

uses
  uDM, dmImagenes;

{$R *.dfm}

procedure TfrmProspectos.ActionImprimir(Action: TBasicAction);
var
    Rep: LibraryGauss_Intf.TReporteF;
begin
  //-- envio del reporte--//
    Rep:=DM.Servidor.BuscarReporte('Directorio de Alumnos');
    DM.Parametros.Factura:=0;
    try
     DM.Imprimir(Rep.SQL1, Rep.SQL2, Rep.Template, 'IMPRIMIENDO...', Rep.CampoJoin, False)
    finally
     Rep.Free;
    end;
end;

procedure TfrmProspectos.cdsCatalogoNewRecord(DataTable: TDADataTable);
begin
  inherited;
  cdsCatalogo.FieldByName('IDPROSPECTO').AsInteger:= DM.Servidor.Folio('IDPROSPECTO','');
  cxTabSheet3.Enabled:= True;
end;

procedure TfrmProspectos.FormCreate(Sender: TObject);
var
  Aux: TStringStream;
begin
  Campo:='IDPROSPECTO';
  inherited;
  cdsStatus.Close;
  cdsStatus.Open;

  pgcCatalogo.ActivePageIndex:=0;
  cxPageControl1.ActivePageIndex:=0;
end;

procedure TfrmProspectos.memObservacionesKeyPress(Sender: TObject; var Key: Char);
begin
  inherited;
  cdsCatalogo.Edit;
end;

procedure TfrmProspectos.RegisterActions;
begin
  inherited;
  RegisterAction(AppActions.actImprimir, ActionImprimir);
end;

procedure TfrmProspectos.UpdateActionsState;
begin
  inherited;

end;

initialization
  ModuleInfoManager.RegisterModule('Prospectos', TfrmProspectos);

end.
